import * as $rjs_core from '../../runtime/core.js';import * as M0 from "../racket/private/kw-file.rkt.js";import * as M1 from "../racket/private/reading-param.rkt.js";import * as M2 from "./private/dirs.rkt.js";import * as M3 from "../racket/private/member.rkt.js";import * as M4 from "../../runtime/kernel.rkt.js";import * as M5 from "../racket/private/for.rkt.js";import * as M6 from "../../runtime/unsafe.rkt.js";var cross_system_table = false;var system_type_symbols = $rjs_core.Pair.makeList($rjs_core.Symbol.make("os"), $rjs_core.Symbol.make("word"), $rjs_core.Symbol.make("gc"), $rjs_core.Symbol.make("link"), $rjs_core.Symbol.make("machine"), $rjs_core.Symbol.make("so-suffix"), $rjs_core.Symbol.make("so-mode"), $rjs_core.Symbol.make("fs-change"));var compute_cross_bang_ = function() {if (cross_system_table) {var if_res1449 = M4.rvoid();} else {var lib_dir2500 = M2.find_lib_dir();if (lib_dir2500) {var f2502 = M4.build_path(lib_dir2500,"system.rktd");if (M4.file_exists_p(f2502)) {var ht2503 = M1.call_with_default_reading_parameterization(function() {var f52504 = f2502;var read62505 = M4.read;if (M4.variable_reference_constant_p(M0.__rjs_quoted__.call_with_input_file_times_63)) {var if_res1429 = M0.__rjs_quoted__.call_with_input_file_times_61(false,false,f52504,read62505);} else {var if_res1429 = M0.__rjs_quoted__.call_with_input_file_times_63(f52504,read62505);}return if_res1429;});if (M4.hash_p(ht2503)) {var lst2506 = M4.list_times_($rjs_core.Symbol.make("library-subpath"),$rjs_core.Symbol.make("library-subpath-convention"),system_type_symbols);if (M4.list_p(lst2506)) {var if_res1430 = M4.rvoid();} else {var if_res1430 = M5.__rjs_quoted__.in_list(lst2506);}if_res1430;var for_loop2507 = function(result2508, lst2509) {if (M4.pair_p(lst2509)) {var sym2510 = M6.unsafe_car(lst2509);if (true) {var result2512 = result2508;var result2513 = M4.hash_ref(ht2503,sym2510,false);var result2511 = M4.values(result2513);if (true) {var if_res1431 = M4.not($rjs_core.attachProcedureArity(function() {var x2514 = $rjs_core.Pair.listFromArray($rjs_core.argumentsToArray(arguments));return M4.not(result2511);})(sym2510));} else {var if_res1431 = false;}if (if_res1431) {var if_res1432 = for_loop2507(result2511,M6.unsafe_cdr(lst2509));} else {var if_res1432 = result2511;}var if_res1433 = if_res1432;} else {var if_res1433 = result2508;}var if_res1434 = if_res1433;} else {var if_res1434 = result2508;}return if_res1434;};if (for_loop2507(true,lst2506)) {var lst2515 = system_type_symbols;if (M4.list_p(lst2515)) {var if_res1435 = M4.rvoid();} else {var if_res1435 = M5.__rjs_quoted__.in_list(lst2515);}if_res1435;var for_loop2516 = function(result2517, lst2518) {if (M4.pair_p(lst2518)) {var sym2519 = M6.unsafe_car(lst2518);if (true) {var result2521 = result2517;var or_part2522 = M4.eq_p(sym2519,$rjs_core.Symbol.make("machine"));if (or_part2522) {var if_res1436 = or_part2522;} else {var if_res1436 = M4.eq_p(sym2519,$rjs_core.Symbol.make("gc"));}if (if_res1436) {var if_res1437 = result2521;} else {var result2523 = result2521;var result2524 = M4.equal_p(M4.hash_ref(ht2503,sym2519),M4.system_type(sym2519));var if_res1437 = M4.values(result2524);}var result2520 = if_res1437;if (true) {var if_res1438 = M4.not($rjs_core.attachProcedureArity(function() {var x2525 = $rjs_core.Pair.listFromArray($rjs_core.argumentsToArray(arguments));return M4.not(result2520);})(sym2519));} else {var if_res1438 = false;}if (if_res1438) {var if_res1439 = for_loop2516(result2520,M6.unsafe_cdr(lst2518));} else {var if_res1439 = result2520;}var if_res1440 = if_res1439;} else {var if_res1440 = result2517;}var if_res1441 = if_res1440;} else {var if_res1441 = result2517;}return if_res1441;};if (for_loop2516(true,lst2515)) {var if_res1442 = M4.equal_p(M4.bytes__gt_path(M4.hash_ref(ht2503,$rjs_core.Symbol.make("library-subpath")),M4.hash_ref(ht2503,$rjs_core.Symbol.make("library-subpath-convention"))),M4.system_library_subpath(false));} else {var if_res1442 = false;}if (M4.not(if_res1442)) {var if_res1443 = ht2503;} else {var if_res1443 = false;}var if_res1444 = if_res1443;} else {var if_res1444 = false;}var if_res1445 = if_res1444;} else {var if_res1445 = false;}var if_res1446 = if_res1445;} else {var if_res1446 = false;}var if_res1447 = if_res1446;} else {var if_res1447 = false;}var ht2501 = if_res1447;if (ht2501) {cross_system_table = ht2501;var if_res1448 = null;} else {cross_system_table = $rjs_core.Hash.makeEq([], false);var if_res1448 = null;}var if_res1449 = if_res1448;}return if_res1449;};var cl1450 = function() {compute_cross_bang_();var or_part2526 = M4.hash_ref(cross_system_table,$rjs_core.Symbol.make("os"),false);if (or_part2526) {var if_res1453 = or_part2526;} else {var if_res1453 = M4.system_type($rjs_core.Symbol.make("os"));}return if_res1453;};var cl1451 = function(mode2527) {if (M3.memq(mode2527,system_type_symbols)) {var if_res1454 = M4.rvoid();} else {var if_res1454 = M4.raise_argument_error($rjs_core.Symbol.make("cross-system-type"),"(or/c 'os 'word 'gc 'link 'machine 'so-suffix 'so-mode 'fs-change)",mode2527);}if_res1454;compute_cross_bang_();var or_part2528 = M4.hash_ref(cross_system_table,mode2527,false);if (or_part2528) {var if_res1455 = or_part2528;} else {var if_res1455 = M4.system_type(mode2527);}return if_res1455;};var cross_system_type = $rjs_core.attachProcedureArity(function() {var fixed_lam1452 = {'0':cl1450,'1':cl1451}[arguments.length];if (fixed_lam1452!==undefined) {return fixed_lam1452.apply(null,arguments);} else {return M4.error("case-lambda: invalid case");}},[0,1]);var cross_system_library_subpath32529 = function(mode12530, mode22531) {if (mode22531) {var if_res1456 = mode12530;} else {compute_cross_bang_();var if_res1456 = cross_system_type($rjs_core.Symbol.make("gc"));}var mode2532 = if_res1456;if (M3.memq(mode2532,$rjs_core.Pair.makeList(false, $rjs_core.Symbol.make("3m"), $rjs_core.Symbol.make("cgc")))) {var if_res1457 = M4.rvoid();} else {var if_res1457 = M4.raise_argument_error($rjs_core.Symbol.make("cross-system-library-subtype"),"(or/c #f '3m 'cgc)",mode2532);}if_res1457;var let_result1458 = M4.values();compute_cross_bang_();var let_result1459 = M4.values();var bstr2533 = M4.hash_ref(cross_system_table,$rjs_core.Symbol.make("library-subpath"),false);if (bstr2533) {var conv2534 = M4.hash_ref(cross_system_table,$rjs_core.Symbol.make("library-subpath-convention"));var path2535 = M4.bytes__gt_path(bstr2533,conv2534);var tmp2536 = mode2532;if (M4.equal_p(tmp2536,false)) {var if_res1460 = true;} else {var if_res1460 = M4.equal_p(tmp2536,$rjs_core.Symbol.make("cgc"));}if (if_res1460) {var if_res1462 = path2535;} else {if (M4.equal_p(tmp2536,$rjs_core.Symbol.make("3m"))) {var if_res1461 = M4.build_path(path2535,M4.bytes__gt_path(new Uint8Array([51,109]),conv2534));} else {var if_res1461 = M4.rvoid();}var if_res1462 = if_res1461;}var if_res1463 = if_res1462;} else {var if_res1463 = M4.system_library_subpath(mode2532);}return if_res1463;};var cl1464 = function() {return cross_system_library_subpath32529(false,false);};var cl1465 = function(mode12537) {return cross_system_library_subpath32529(mode12537,true);};var cross_system_library_subpath = $rjs_core.attachProcedureArity(function() {var fixed_lam1466 = {'0':cl1464,'1':cl1465}[arguments.length];if (fixed_lam1466!==undefined) {return fixed_lam1466.apply(null,arguments);} else {return M4.error("case-lambda: invalid case");}},[0,1]);var cross_installation_p = function() {compute_cross_bang_();return M4.positive_p(M4.hash_count(cross_system_table));};var __rjs_quoted__ = {};export { __rjs_quoted__,cross_installation_p,cross_system_library_subpath,cross_system_type };